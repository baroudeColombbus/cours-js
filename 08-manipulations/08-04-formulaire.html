<!DOCTYPE html>
<html lang="fr">
<head>
        <meta charset="UTF-8">
        <!-- <meta name="viewport" content="width=device-width, initial-scale=1.0"> -->
        <!-- la ligne suivante vient de getbootstrap et comporte une valeur supplémentaire "shrink-to-fit=no" cela concerne les mobiles -->
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <title>JS VIII- jeu avec keydown</title>
        <!-- CSS de Bootstrap -->
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
        <!-- <link rel="stylesheet" href="../css/style.css"> -->
        <link rel="stylesheet" href="../ccs/themify-icons.css">
        <!-- style perso -->
        <style>

        .bg-gris-leger{
            background-color: #f2f1f1;
        }

        .error {
            /* border: 1px solid red; */
            background-color: red;
            color: #fff;
        }

        .valide {
            background-color: lightgreen;
        }

        </style>
</head>
<body>
    <nav class="navbar navbar-expand-md navbar-dark" style="background-color:#e6a94f;">
        <a class="navbar-brand" href="#">Cours JavaScript</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarsExample04" aria-controls="navbarsExample04" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
      
        <div class="collapse navbar-collapse" id="navbarsExample04">
          <ul class="navbar-nav mr-auto">
            <li class="nav-item active">
              <a class="nav-link" href="#">Accueil <span class="sr-only">(current)</span></a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#">Lien</a>
            </li>
            <li class="nav-item">
              <a class="nav-link disabled" href="#" tabindex="-1" aria-disabled="true">Lien sésactiver</a>
            </li>
            <li class="nav-item">
                <a class="nav-link active" href="08-04-formulaire.html">Formulaire</a>
              </li>
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" href="#" id="dropdown04" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">08-manipulation</a>
              <div class="dropdown-menu" aria-labelledby="dropdown04">
                <a class="dropdown-item" href="08-01-diaporama.html">Diaporama</a>
                <a class="dropdown-item" href="08-02-setInterval.html">SetInterval</a>
                <a class="dropdown-item" href="08-03-keydown.html">Keydown</a>
                <a class="dropdown-item" href="08-04-formulaire.html">Formulaire</a>
                <a class="dropdown-item" href="08-05-toggle.html">Toggle</a>
              </div>
            </li>
          </ul>
          <form class="form-inline my-2 my-md-0">
            <input class="form-control" type="text" placeholder="Search">
          </form>
        </div>
      </nav><!-- fin de la navbar -->
    <div class="jumbotron container">
        <h1 id="titreNiveau1">JS - VIII 04 - Formulaire</h1>
        <p class="lead">Un formulaire</p>
    </div><!-- fin jumbotron -->
    <div class="container border border-primary p-4">

        <div class=" row border border-danger m-2 p-2">
            <div class="col-6 bg-secondary text-white">
                <h2>Fonction ControleForm ()</h2>
            </div><!-- fin de col-6 -->
            <div class="col-6 bg-gradient-light ">
                <form action="formulaire" method="GET" name="formulaire" class="form-inline">
                    <div class="form-group m-1" >
                        <label for="pseudo" class="sr-only">pseudo</label>
                        <input type="text" name="pseudo" id="pseudo" placeholder="votre pseudo" >
                    </div><!-- fin div form-group // always group lable and input in Bootstrap using the class form-group-->

                    <div class="form-group m-1">
                        <label for="mdp" class="sr-only">Mot de passe</label>
                        <input type="password" name="mdp" id="mdp" placeholder="votre mot de passe">
                    </div><!-- fin div form-group // always group lable and input in Bootstrap using the class form-group-->

                    <button type="submit" id="submit" value="ok" class="btn btn-primary" onclick="controleForm()">Ok</button>



                </form><!-- fin de du formulaire -->

                </div><!-- fin div col-->

            </div><!-- fin de row -->


        <div class="row  border border-danger m-2 p-2">
            <div class="col-3 col-6 bg-secondary text-white">
                <h2>Nouvelle fonction inscriptionForm()</h2>
            </div><!-- fin col-3 -->

            <div class="col-9 col-6 bg-secondary text-white">
                <form action="inscription" method="GET" name="inscription" id="form_inscription">
                    <div>
                        <label for="prenom">Prénom *</label>
                        <input type="text" name="prenom" id="prenom"  class="form-control">
                    </div>

                    <div>
                        <label for="nom">Nom *</label>
                        <input type="text" name="nom" id="nom" class="form-control">
                    </div>

                    <div>
                        <label for="email">Email</label>
                        <input type="email" name="email" id="email" class="form-control">
                    </div>

                    <div>
                        <label for="mdp_2">choisissez un mot de passe</label>
                        <input type="password" name="mdp_2" id="mdp_2" class="form-control">
                    </div>

                    <div>
                        <label for="confmdp">confirmez le mot de passe</label>
                        <input type="password" name="confmdp" id="confmdp" class="form-control">
                    </div>

                    <button type="submit" id="submit_2" value="incription" class="btn btn-primary" >S'inscrire</button>
                    <button type="reset" id="reset_form" class="btn btn-warning ">effacer</button>

                </form><!-- fin de form -->

            </div><!-- fin col-9 -->
    </div><!-- fin de row -->
        

    </div><!-- fin container -->

    <footer id="sticky-footer" class="py-4 bg-dark text-white-50">
        <div class="container text-center">
            <small>Copyright &copy; baroude</small>
        </div>
    </footer><!-- fin du footer -->
    <!-- En 1er JQuery, puis Popper.js et le JS de Bootstrap -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js" integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.min.js" integrity="sha384-w1Q4orYjBQndcko6MimVbzY0tgp4pWB4lZ7lr30WKz0vr/aWKhXdBNmNb5D92v7s" crossorigin="anonymous"></script>

    <!-- Mes scripts, Javascript -->

    <script>
     // contrôle du formulaire
    function controleForm() {
        event.preventDefault(); //  event.preventDefault() à utiliser pour débugger seulement
        if ((document.formulaire.pseudo.value.length < 5) || (document.formulaire.pseudo.value.length > 15)){
            console.log(document.formulaire.pseudo.value.length);
            alert('Le pseudo doit être compris entre 5 et 15 caractères');
        }

        if (document.formulaire.mdp.value.length < 3 || document.formulaire.mdp.value.length > 12);
        alert('Le mot de passe doit être compris entre 3 et 12 caractères');
    }
        
    // contrôle du formulaire d'inscription 
    // récupération du formulaire par son id 
    let formInscrip = document.getElementById('form_inscription');
    // écoute l'envoi du formulaire
    formInscrip.addEventListener('submit', inscriptionForm)

    // fonction pour traiter le formulaire
    function inscriptionForm(event) {
        // permet de ne pas envoyer lz formulaire, pour ne pas rafraîchir la page
        event.preventDefault();
        //console.log(event.target.prenom)

        // expression regulière  pour valider les email

        let regex = /([a-z0-9](\.?|\_|\-))*@([a-z0-9]{2,})(\.[a-z]{2,}){1,}/;
        //let regex = new RegExp ("[a-z0-9](\.?|\_|\-))*@([a-z0-9]{2,})(\.[a-z]{2,}){1,}");


        // récuperation du contenu des champs
            let prenom  = event.target.prenom.value, 
                nom     = event.target.nom.value, 
                email   = event.target.email.value,
                mdp_2   = event.target.mdp_2.value, 
                confmdp = event.target.confmdp.value;
            console.log(prenom,nom,email,mdp_2,confmdp);

            if(prenom !== '' || nom !== ''){
                    if(prenom.length < 2){
                        //classList représente toute les classes de l'élément event.target
                        //add ajoute une class à l'élément event.target
                        // console.log(event.target.prenom.classList);
                        event.target.prenom.classList.add("error");
                        event.target.prenom.classList.remove("valide");
                    }else {
                        event.target.prenom.classList.add("valide");
                        event.target.prenom.classList.remove("error");
                    }
                    if (nom.length < 4){
                        event.target.nom.classList.add("error");
                        event.target.nom.classList.remove("valide");
                    }else {
                    event.target.nom.classList.add("valide");
                    event.target.nom.classList.remove("error");
                    }
            }//Fin condition prenom / nom
            //Nouvelle condition les mots de passe sont-ils identiques
            if(confmdp !== mdp_2){//Si ils sont différents
                    event.target.confmdp.classList.add("error");
                    event.target.confmdp.classList.remove("valide");
                    event.target.mdp_2.classList.add("error");
                    event.target.mdp_2.classList.remove("valide");
                } else if(mdp_2.length < 5 || mdp_2.length > 12){
                    event.target.mdp_2.classList.add("error");
                    event.target.mdp_2.classList.remove("valide");
                } else {// tout est bon
                    event.target.mdp_2.classList.add("valide")
                    event.target.mdp_2.classList.remove("error")
                    event.target.confmdp.classList.add("valide");
                    event.target.confmdp.classList.remove("error");
                }

                // console.log(regex.test(email));
                //if(!regex.test(email)){}
                if(!regex.test(email)=== false){
                    event.target.email.classList.add("error");
                    event.target.email.classList.remove("error");

                } else {
                    event.target.email.classList.remove("error");
                    event.target.email.classList.add("error");

                }

        }//Fin fonction
        //document.getElementById("reset_form").addEventListener("click",(e) => {});
        document.getElementById("reset_form").addEventListener("click", function(event) {
            console.log(event.target.form);
            event.target.form.prenom.value = "";
            event.target.form.nom.value = "";
            event.target.form.email.value = "";
            event.target.form.mdp_2.value = "";
            event.target.form.confmdp.value = "";
        });


// submit_2 est un paramètre 

// e or event est un argument




    </script><!-- fin de script perso -->


</body><!-- fin de body -->
</html>